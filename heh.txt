#include<stdio.h>
#include<stdlib.h>
#include<string.h>
#include<mpi.h>
#define MAX 1000
int main(int argc,char*argv[]){
    int n,rank;
    char *input_str,*buf,ch,str[MAX];
    MPI_Init(&argc,&argv);
    MPI_Comm_size(MPI_COMM_WORLD,&n);
    MPI_Comm_rank(MPI_COMM_WORLD,&rank);
    if(rank==0){
        printf("Enter string of length %d: ",n);
        input_str=(char*)malloc(n*sizeof(char));
        for(int i=0;i<n;i++)
            scanf("%c",&input_str[i]);
    }
    buf=(char*)malloc((n+1)*sizeof(char));
    MPI_Scatter(input_str,1,MPI_CHAR,&ch,1,MPI_CHAR,0,MPI_COMM_WORLD);
    for(int i=0;i<rank+1;i++)
        buf[i]=ch;
    buf[rank+1]='\0';
    MPI_Gather(buf,n+1,MPI_CHAR,str,n+1,MPI_CHAR,0,MPI_COMM_WORLD);
    if(rank==0){
        int k=0;
        for(int i=0;i<(n+1)*(n+1);i+=n+1){
            int j=i;
            while(str[j]!='\0'){
                str[k++]=str[j++];
            }
        }
        str[n*(n+1)/2]='\0';
        printf("Result string is %s\n",str);
    }
    MPI_Finalize();
    return 0;
}